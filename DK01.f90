!*****************************************************************************!
!
Module DBSK01
!
!*****************************************************************************!
!
USE DBSI01
USE DSlib
USE ERRORS
USE DImach
IMPLICIT NONE

!--- CONTAINS DBESK0, DBESK1, DBSK0E, DBSK1E

CONTAINS

!=============================================================================!
!
!DECK DBSK0E
FUNCTION DBSK0E (X)
!
!=============================================================================!
!
!***BEGIN PROLOGUE  DBSK0E
!***PURPOSE  Compute the exponentially scaled modified (hyperbolic)
!            Bessel function of the third kind of order zero.
!***LIBRARY   SLATEC (FNLIB)
!***CATEGORY  C10B1
!***TYPE      DOUBLE PRECISION (BESK0E-S, DBSK0E-D)
!***KEYWORDS  EXPONENTIALLY SCALED, FNLIB, HYPERBOLIC BESSEL FUNCTION,
!             MODIFIED BESSEL FUNCTION, ORDER ZERO, SPECIAL FUNCTIONS,
!             THIRD KIND
!***AUTHOR  Fullerton, W., (LANL)
!***DESCRIPTION
!
! DBSK0E(X) computes the double precision exponentially scaled
! modified (hyperbolic) Bessel function of the third kind of
! order zero for positive double precision argument X.
!
! Series for BK0        on the interval  0.          to  4.00000E+00
!                                        with weighted error   3.08E-33
!                                         log weighted error  32.51
!                               significant figures required  32.05
!                                    decimal places required  33.11
!
! Series for AK0        on the interval  1.25000E-01 to  5.00000E-01
!                                        with weighted error   2.85E-32
!                                         log weighted error  31.54
!                               significant figures required  30.19
!                                    decimal places required  32.33
!
! Series for AK02       on the interval  0.          to  1.25000E-01
!                                        with weighted error   2.30E-32
!                                         log weighted error  31.64
!                               significant figures required  29.68
!                                    decimal places required  32.40
!
!***REFERENCES  (NONE)
!***ROUTINES CALLED  D1MACH, DBESI0, DCSEVL, INITDS, XERMSG
!***REVISION HISTORY  (YYMMDD)
!   770701  DATE WRITTEN
!   890531  Changed all specific intrinsics to generic.  (WRB)
!   890531  REVISION DATE from Version 3.2
!   891214  Prologue converted to Version 4.0 format.  (BAB)
!   900315  CALLs to XERROR changed to CALLs to XERMSG.  (THJ)
!***END PROLOGUE  DBSK0E
      DOUBLE PRECISION X, BK0CS(16), AK0CS(38), AK02CS(33), XSML, Y, DBSK0E
      LOGICAL FIRST
      REAL ETA
      INTEGER NTK0, NTAK0, NTAK02
      SAVE BK0CS, AK0CS, AK02CS, NTK0, NTAK0, NTAK02, XSML, FIRST
      DATA BK0CS(  1) / -.353273932339027687201140060063153D-1   /
      DATA BK0CS(  2) / +.344289899924628486886344927529213D+0   /
      DATA BK0CS(  3) / +.359799365153615016265721303687231D-1   /
      DATA BK0CS(  4) / +.126461541144692592338479508673447D-2   /
      DATA BK0CS(  5) / +.228621210311945178608269830297585D-4   /
      DATA BK0CS(  6) / +.253479107902614945730790013428354D-6   /
      DATA BK0CS(  7) / +.190451637722020885897214059381366D-8   /
      DATA BK0CS(  8) / +.103496952576336245851008317853089D-10  /
      DATA BK0CS(  9) / +.425981614279108257652445327170133D-13  /
      DATA BK0CS( 10) / +.137446543588075089694238325440000D-15  /
      DATA BK0CS( 11) / +.357089652850837359099688597333333D-18  /
      DATA BK0CS( 12) / +.763164366011643737667498666666666D-21  /
      DATA BK0CS( 13) / +.136542498844078185908053333333333D-23  /
      DATA BK0CS( 14) / +.207527526690666808319999999999999D-26  /
      DATA BK0CS( 15) / +.271281421807298560000000000000000D-29  /
      DATA BK0CS( 16) / +.308259388791466666666666666666666D-32  /
      DATA AK0CS(  1) / -.7643947903327941424082978270088D-1     /
      DATA AK0CS(  2) / -.2235652605699819052023095550791D-1     /
      DATA AK0CS(  3) / +.7734181154693858235300618174047D-3     /
      DATA AK0CS(  4) / -.4281006688886099464452146435416D-4     /
      DATA AK0CS(  5) / +.3081700173862974743650014826660D-5     /
      DATA AK0CS(  6) / -.2639367222009664974067448892723D-6     /
      DATA AK0CS(  7) / +.2563713036403469206294088265742D-7     /
      DATA AK0CS(  8) / -.2742705549900201263857211915244D-8     /
      DATA AK0CS(  9) / +.3169429658097499592080832873403D-9     /
      DATA AK0CS( 10) / -.3902353286962184141601065717962D-10    /
      DATA AK0CS( 11) / +.5068040698188575402050092127286D-11    /
      DATA AK0CS( 12) / -.6889574741007870679541713557984D-12    /
      DATA AK0CS( 13) / +.9744978497825917691388201336831D-13    /
      DATA AK0CS( 14) / -.1427332841884548505389855340122D-13    /
      DATA AK0CS( 15) / +.2156412571021463039558062976527D-14    /
      DATA AK0CS( 16) / -.3349654255149562772188782058530D-15    /
      DATA AK0CS( 17) / +.5335260216952911692145280392601D-16    /
      DATA AK0CS( 18) / -.8693669980890753807639622378837D-17    /
      DATA AK0CS( 19) / +.1446404347862212227887763442346D-17    /
      DATA AK0CS( 20) / -.2452889825500129682404678751573D-18    /
      DATA AK0CS( 21) / +.4233754526232171572821706342400D-19    /
      DATA AK0CS( 22) / -.7427946526454464195695341294933D-20    /
      DATA AK0CS( 23) / +.1323150529392666866277967462400D-20    /
      DATA AK0CS( 24) / -.2390587164739649451335981465599D-21    /
      DATA AK0CS( 25) / +.4376827585923226140165712554666D-22    /
      DATA AK0CS( 26) / -.8113700607345118059339011413333D-23    /
      DATA AK0CS( 27) / +.1521819913832172958310378154666D-23    /
      DATA AK0CS( 28) / -.2886041941483397770235958613333D-24    /
      DATA AK0CS( 29) / +.5530620667054717979992610133333D-25    /
      DATA AK0CS( 30) / -.1070377329249898728591633066666D-25    /
      DATA AK0CS( 31) / +.2091086893142384300296328533333D-26    /
      DATA AK0CS( 32) / -.4121713723646203827410261333333D-27    /
      DATA AK0CS( 33) / +.8193483971121307640135680000000D-28    /
      DATA AK0CS( 34) / -.1642000275459297726780757333333D-28    /
      DATA AK0CS( 35) / +.3316143281480227195890346666666D-29    /
      DATA AK0CS( 36) / -.6746863644145295941085866666666D-30    /
      DATA AK0CS( 37) / +.1382429146318424677635413333333D-30    /
      DATA AK0CS( 38) / -.2851874167359832570811733333333D-31    /
      DATA AK02CS(  1) / -.1201869826307592239839346212452D-1     /
      DATA AK02CS(  2) / -.9174852691025695310652561075713D-2     /
      DATA AK02CS(  3) / +.1444550931775005821048843878057D-3     /
      DATA AK02CS(  4) / -.4013614175435709728671021077879D-5     /
      DATA AK02CS(  5) / +.1567831810852310672590348990333D-6     /
      DATA AK02CS(  6) / -.7770110438521737710315799754460D-8     /
      DATA AK02CS(  7) / +.4611182576179717882533130529586D-9     /
      DATA AK02CS(  8) / -.3158592997860565770526665803309D-10    /
      DATA AK02CS(  9) / +.2435018039365041127835887814329D-11    /
      DATA AK02CS( 10) / -.2074331387398347897709853373506D-12    /
      DATA AK02CS( 11) / +.1925787280589917084742736504693D-13    /
      DATA AK02CS( 12) / -.1927554805838956103600347182218D-14    /
      DATA AK02CS( 13) / +.2062198029197818278285237869644D-15    /
      DATA AK02CS( 14) / -.2341685117579242402603640195071D-16    /
      DATA AK02CS( 15) / +.2805902810643042246815178828458D-17    /
      DATA AK02CS( 16) / -.3530507631161807945815482463573D-18    /
      DATA AK02CS( 17) / +.4645295422935108267424216337066D-19    /
      DATA AK02CS( 18) / -.6368625941344266473922053461333D-20    /
      DATA AK02CS( 19) / +.9069521310986515567622348800000D-21    /
      DATA AK02CS( 20) / -.1337974785423690739845005311999D-21    /
      DATA AK02CS( 21) / +.2039836021859952315522088960000D-22    /
      DATA AK02CS( 22) / -.3207027481367840500060869973333D-23    /
      DATA AK02CS( 23) / +.5189744413662309963626359466666D-24    /
      DATA AK02CS( 24) / -.8629501497540572192964607999999D-25    /
      DATA AK02CS( 25) / +.1472161183102559855208038400000D-25    /
      DATA AK02CS( 26) / -.2573069023867011283812351999999D-26    /
      DATA AK02CS( 27) / +.4601774086643516587376640000000D-27    /
      DATA AK02CS( 28) / -.8411555324201093737130666666666D-28    /
      DATA AK02CS( 29) / +.1569806306635368939301546666666D-28    /
      DATA AK02CS( 30) / -.2988226453005757788979199999999D-29    /
      DATA AK02CS( 31) / +.5796831375216836520618666666666D-30    /
      DATA AK02CS( 32) / -.1145035994347681332155733333333D-30    /
      DATA AK02CS( 33) / +.2301266594249682802005333333333D-31    /
      DATA FIRST /.TRUE./
!***FIRST EXECUTABLE STATEMENT  DBSK0E
      IF (FIRST) THEN
         ETA = 0.1*REAL(D1MACH(3))
         NTK0 = INITDS (BK0CS, 16, ETA)
         NTAK0 = INITDS (AK0CS, 38, ETA)
         NTAK02 = INITDS (AK02CS, 33, ETA)
         XSML = SQRT(4.0D0*D1MACH(3))
      ENDIF
      FIRST = .FALSE.
!
      IF (X .LE. 0.D0) CALL XERMSG ('SLATEC', 'DBSK0E', 'X IS ZERO OR NEGATIVE', 2, 2)
      IF (X.GT.2.0D0) GO TO 20
!
      Y = 0.D0
      IF (X.GT.XSML) Y = X*X
      DBSK0E = EXP(X)*(-LOG(0.5D0*X)*DBESI0(X) - 0.25D0 + DCSEVL (.5D0*Y-1.D0, BK0CS, NTK0))
      RETURN
!
 20   IF (X.LE.8.D0) DBSK0E = (1.25D0 + DCSEVL ((16.D0/X-5.D0)/3.D0, AK0CS, NTAK0))/SQRT(X)
      IF (X.GT.8.D0) DBSK0E = (1.25D0 + DCSEVL (16.D0/X-1.D0, AK02CS, NTAK02))/SQRT(X)
!
      RETURN
END FUNCTION DBSK0E


!---DECK DBSK1E
!
!=============================================================================!
!
FUNCTION DBSK1E (X)
!
!=============================================================================!
!
!***BEGIN PROLOGUE  DBSK1E
!***PURPOSE  Compute the exponentially scaled modified (hyperbolic)
!            Bessel function of the third kind of order one.
!***LIBRARY   SLATEC (FNLIB)
!***CATEGORY  C10B1
!***TYPE      DOUBLE PRECISION (BESK1E-S, DBSK1E-D)
!***KEYWORDS  EXPONENTIALLY SCALED, FNLIB, HYPERBOLIC BESSEL FUNCTION,
!             MODIFIED BESSEL FUNCTION, ORDER ONE, SPECIAL FUNCTIONS,
!             THIRD KIND
!***AUTHOR  Fullerton, W., (LANL)
!***DESCRIPTION
!
! DBSK1E(S) computes the double precision exponentially scaled
! modified (hyperbolic) Bessel function of the third kind of order
! one for positive double precision argument X.
!
! Series for BK1        on the interval  0.          to  4.00000E+00
!                                        with weighted error   9.16E-32
!                                         log weighted error  31.04
!                               significant figures required  30.61
!                                    decimal places required  31.64
!
! Series for AK1        on the interval  1.25000E-01 to  5.00000E-01
!                                        with weighted error   3.07E-32
!                                         log weighted error  31.51
!                               significant figures required  30.71
!                                    decimal places required  32.30
!
! Series for AK12       on the interval  0.          to  1.25000E-01
!                                        with weighted error   2.41E-32
!                                         log weighted error  31.62
!                               significant figures required  30.25
!                                    decimal places required  32.38
!
!***REFERENCES  (NONE)
!***ROUTINES CALLED  D1MACH, DBESI1, DCSEVL, INITDS, XERMSG
!***REVISION HISTORY  (YYMMDD)
!   770701  DATE WRITTEN
!   890531  Changed all specific intrinsics to generic.  (WRB)
!   890531  REVISION DATE from Version 3.2
!   891214  Prologue converted to Version 4.0 format.  (BAB)
!   900315  CALLs to XERROR changed to CALLs to XERMSG.  (THJ)
!***END PROLOGUE  DBSK1E
      DOUBLE PRECISION X, BK1CS(16), AK1CS(38), AK12CS(33), XMIN, XSML, Y, DBSK1E
      LOGICAL FIRST
      REAL ETA
      INTEGER NTK1, NTAK1, NTAK12
      SAVE BK1CS, AK1CS, AK12CS, NTK1, NTAK1, NTAK12, XMIN, XSML, FIRST
      DATA BK1CS(  1) / +.25300227338947770532531120868533D-1   /
      DATA BK1CS(  2) / -.35315596077654487566723831691801D+0    /
      DATA BK1CS(  3) / -.12261118082265714823479067930042D+0    /
      DATA BK1CS(  4) / -.69757238596398643501812920296083D-2    /
      DATA BK1CS(  5) / -.17302889575130520630176507368979D-3    /
      DATA BK1CS(  6) / -.24334061415659682349600735030164D-5    /
      DATA BK1CS(  7) / -.22133876307347258558315252545126D-7    /
      DATA BK1CS(  8) / -.14114883926335277610958330212608D-9    /
      DATA BK1CS(  9) / -.66669016941993290060853751264373D-12   /
      DATA BK1CS( 10) / -.24274498505193659339263196864853D-14   /
      DATA BK1CS( 11) / -.70238634793862875971783797120000D-17   /
      DATA BK1CS( 12) / -.16543275155100994675491029333333D-19   /
      DATA BK1CS( 13) / -.32338347459944491991893333333333D-22   /
      DATA BK1CS( 14) / -.53312750529265274999466666666666D-25   /
      DATA BK1CS( 15) / -.75130407162157226666666666666666D-28   /
      DATA BK1CS( 16) / -.91550857176541866666666666666666D-31   /
      DATA AK1CS(  1) / +.27443134069738829695257666227266D+0    /
      DATA AK1CS(  2) / +.75719899531993678170892378149290D-1   /
      DATA AK1CS(  3) / -.14410515564754061229853116175625D-2    /
      DATA AK1CS(  4) / +.66501169551257479394251385477036D-4    /
      DATA AK1CS(  5) / -.43699847095201407660580845089167D-5    /
      DATA AK1CS(  6) / +.35402774997630526799417139008534D-6    /
      DATA AK1CS(  7) / -.33111637792932920208982688245704D-7    /
      DATA AK1CS(  8) / +.34459775819010534532311499770992D-8    /
      DATA AK1CS(  9) / -.38989323474754271048981937492758D-9    /
      DATA AK1CS( 10) / +.47208197504658356400947449339005D-10   /
      DATA AK1CS( 11) / -.60478356628753562345373591562890D-11   /
      DATA AK1CS( 12) / +.81284948748658747888193837985663D-12   /
      DATA AK1CS( 13) / -.11386945747147891428923915951042D-12   /
      DATA AK1CS( 14) / +.16540358408462282325972948205090D-13   /
      DATA AK1CS( 15) / -.24809025677068848221516010440533D-14   /
      DATA AK1CS( 16) / +.38292378907024096948429227299157D-15   /
      DATA AK1CS( 17) / -.60647341040012418187768210377386D-16   /
      DATA AK1CS( 18) / +.98324256232648616038194004650666D-17   /
      DATA AK1CS( 19) / -.16284168738284380035666620115626D-17   /
      DATA AK1CS( 20) / +.27501536496752623718284120337066D-18   /
      DATA AK1CS( 21) / -.47289666463953250924281069568000D-19   /
      DATA AK1CS( 22) / +.82681500028109932722392050346666D-20   /
      DATA AK1CS( 23) / -.14681405136624956337193964885333D-20   /
      DATA AK1CS( 24) / +.26447639269208245978085894826666D-21   /
      DATA AK1CS( 25) / -.48290157564856387897969868800000D-22   /
      DATA AK1CS( 26) / +.89293020743610130180656332799999D-23   /
      DATA AK1CS( 27) / -.16708397168972517176997751466666D-23   /
      DATA AK1CS( 28) / +.31616456034040694931368618666666D-24   /
      DATA AK1CS( 29) / -.60462055312274989106506410666666D-25   /
      DATA AK1CS( 30) / +.11678798942042732700718421333333D-25   /
      DATA AK1CS( 31) / -.22773741582653996232867840000000D-26   /
      DATA AK1CS( 32) / +.44811097300773675795305813333333D-27   /
      DATA AK1CS( 33) / -.88932884769020194062336000000000D-28   /
      DATA AK1CS( 34) / +.17794680018850275131392000000000D-28   /
      DATA AK1CS( 35) / -.35884555967329095821994666666666D-29   /
      DATA AK1CS( 36) / +.72906290492694257991679999999999D-30   /
      DATA AK1CS( 37) / -.14918449845546227073024000000000D-30   /
      DATA AK1CS( 38) / +.30736573872934276300799999999999D-31   /
      DATA AK12CS(  1) / +.6379308343739001036600488534102D-1    /
      DATA AK12CS(  2) / +.2832887813049720935835030284708D-1    /
      DATA AK12CS(  3) / -.2475370673905250345414545566732D-3     /
      DATA AK12CS(  4) / +.5771972451607248820470976625763D-5     /
      DATA AK12CS(  5) / -.2068939219536548302745533196552D-6     /
      DATA AK12CS(  6) / +.9739983441381804180309213097887D-8     /
      DATA AK12CS(  7) / -.5585336140380624984688895511129D-9     /
      DATA AK12CS(  8) / +.3732996634046185240221212854731D-10    /
      DATA AK12CS(  9) / -.2825051961023225445135065754928D-11    /
      DATA AK12CS( 10) / +.2372019002484144173643496955486D-12    /
      DATA AK12CS( 11) / -.2176677387991753979268301667938D-13    /
      DATA AK12CS( 12) / +.2157914161616032453939562689706D-14    /
      DATA AK12CS( 13) / -.2290196930718269275991551338154D-15    /
      DATA AK12CS( 14) / +.2582885729823274961919939565226D-16    /
      DATA AK12CS( 15) / -.3076752641268463187621098173440D-17    /
      DATA AK12CS( 16) / +.3851487721280491597094896844799D-18    /
      DATA AK12CS( 17) / -.5044794897641528977117282508800D-19    /
      DATA AK12CS( 18) / +.6888673850418544237018292223999D-20    /
      DATA AK12CS( 19) / -.9775041541950118303002132480000D-21    /
      DATA AK12CS( 20) / +.1437416218523836461001659733333D-21    /
      DATA AK12CS( 21) / -.2185059497344347373499733333333D-22    /
      DATA AK12CS( 22) / +.3426245621809220631645388800000D-23    /
      DATA AK12CS( 23) / -.5531064394246408232501248000000D-24    /
      DATA AK12CS( 24) / +.9176601505685995403782826666666D-25    /
      DATA AK12CS( 25) / -.1562287203618024911448746666666D-25    /
      DATA AK12CS( 26) / +.2725419375484333132349439999999D-26    /
      DATA AK12CS( 27) / -.4865674910074827992378026666666D-27    /
      DATA AK12CS( 28) / +.8879388552723502587357866666666D-28    /
      DATA AK12CS( 29) / -.1654585918039257548936533333333D-28    /
      DATA AK12CS( 30) / +.3145111321357848674303999999999D-29    /
      DATA AK12CS( 31) / -.6092998312193127612416000000000D-30    /
      DATA AK12CS( 32) / +.1202021939369815834623999999999D-30    /
      DATA AK12CS( 33) / -.2412930801459408841386666666666D-31    /
      DATA FIRST /.TRUE./
!***FIRST EXECUTABLE STATEMENT  DBSK1E
      IF (FIRST) THEN
         ETA = 0.1*REAL(D1MACH(3))
         NTK1 = INITDS (BK1CS, 16, ETA)
         NTAK1 = INITDS (AK1CS, 38, ETA)
         NTAK12 = INITDS (AK12CS, 33, ETA)
!
         XMIN = EXP (MAX(LOG(D1MACH(1)), -LOG(D1MACH(2))) + 0.01D0)
         XSML = SQRT(4.0D0*D1MACH(3))
      ENDIF
      FIRST = .FALSE.
!
      IF (X .LE. 0.D0) CALL XERMSG ('SLATEC', 'DBSK1E', 'X IS ZERO OR NEGATIVE', 2, 2)
      IF (X.GT.2.0D0) GO TO 20
!
      IF (X .LT. XMIN) CALL XERMSG ('SLATEC', 'DBSK1E', 'X SO SMALL K1 OVERFLOWS', 3, 2)
      Y = 0.D0
      IF (X.GT.XSML) Y = X*X
      DBSK1E = EXP(X)*(LOG(0.5D0*X)*DBESI1(X) + (0.75D0 + DCSEVL (0.5D0*Y-1.D0, BK1CS, NTK1))/X )
      RETURN
!
 20   IF (X.LE.8.D0) DBSK1E = (1.25D0 + DCSEVL ((16.D0/X-5.D0)/3.D0, AK1CS, NTAK1))/SQRT(X)
      IF (X.GT.8.D0) DBSK1E = (1.25D0 + DCSEVL (16.D0/X-1.D0, AK12CS, NTAK12))/SQRT(X)
!
      RETURN
END FUNCTION DBSK1E
!--- DECK DBESK0
!=============================================================================!
!
FUNCTION DBESK0 (X)
!
!=============================================================================!
!
!***BEGIN PROLOGUE  DBESK0
!***PURPOSE  Compute the modified (hyperbolic) Bessel function of the
!            third kind of order zero.
!***LIBRARY   SLATEC (FNLIB)
!***CATEGORY  C10B1
!***TYPE      DOUBLE PRECISION (BESK0-S, DBESK0-D)
!***KEYWORDS  FNLIB, HYPERBOLIC BESSEL FUNCTION,
!             MODIFIED BESSEL FUNCTION, ORDER ZERO, SPECIAL FUNCTIONS,
!             THIRD KIND
!***AUTHOR  Fullerton, W., (LANL)
!***DESCRIPTION
!
! DBESK0(X) calculates the double precision modified (hyperbolic)
! Bessel function of the third kind of order zero for double
! precision argument X.  The argument must be greater than zero
! but not so large that the result underflows.
!
! Series for BK0        on the interval  0.          to  4.00000E+00
!                                        with weighted error   3.08E-33
!                                         log weighted error  32.51
!                               significant figures required  32.05
!                                    decimal places required  33.11
!
!***REFERENCES  (NONE)
!***ROUTINES CALLED  D1MACH, DBESI0, DBSK0E, DCSEVL, INITDS, XERMSG
!***REVISION HISTORY  (YYMMDD)
!   770701  DATE WRITTEN
!   890531  Changed all specific intrinsics to generic.  (WRB)
!   890531  REVISION DATE from Version 3.2
!   891214  Prologue converted to Version 4.0 format.  (BAB)
!   900315  CALLs to XERROR changed to CALLs to XERMSG.  (THJ)
!***END PROLOGUE  DBESK0
      DOUBLE PRECISION X, BK0CS(16), XMAX, XMAXT, XSML, Y, DBESK0
      LOGICAL FIRST
      INTEGER NTK0
      SAVE BK0CS, NTK0, XSML, XMAX, FIRST
      DATA BK0CS(  1) / -.353273932339027687201140060063153D-1    /
      DATA BK0CS(  2) / +.344289899924628486886344927529213D+0    /
      DATA BK0CS(  3) / +.359799365153615016265721303687231D-1    /
      DATA BK0CS(  4) / +.126461541144692592338479508673447D-2    /
      DATA BK0CS(  5) / +.228621210311945178608269830297585D-4    /
      DATA BK0CS(  6) / +.253479107902614945730790013428354D-6    /
      DATA BK0CS(  7) / +.190451637722020885897214059381366D-8    /
      DATA BK0CS(  8) / +.103496952576336245851008317853089D-10   /
      DATA BK0CS(  9) / +.425981614279108257652445327170133D-13   /
      DATA BK0CS( 10) / +.137446543588075089694238325440000D-15   /
      DATA BK0CS( 11) / +.357089652850837359099688597333333D-18   /
      DATA BK0CS( 12) / +.763164366011643737667498666666666D-21   /
      DATA BK0CS( 13) / +.136542498844078185908053333333333D-23   /
      DATA BK0CS( 14) / +.207527526690666808319999999999999D-26   /
      DATA BK0CS( 15) / +.271281421807298560000000000000000D-29   /
      DATA BK0CS( 16) / +.308259388791466666666666666666666D-32   /
      DATA FIRST /.TRUE./
!***FIRST EXECUTABLE STATEMENT  DBESK0
      IF (FIRST) THEN
         NTK0 = INITDS (BK0CS, 16, 0.1*REAL(D1MACH(3)))
         XSML = SQRT(4.0D0*D1MACH(3))
         XMAXT = -LOG(D1MACH(1))
         XMAX = XMAXT - 0.5D0*XMAXT*LOG(XMAXT)/(XMAXT+0.5D0)
      ENDIF
      FIRST = .FALSE.
!
      IF (X .LE. 0.D0) CALL XERMSG ('SLATEC', 'DBESK0', 'X IS ZERO OR NEGATIVE', 2, 2)
      IF (X.GT.2.0D0) GO TO 20
!
      Y = 0.D0
      IF (X.GT.XSML) Y = X*X
      DBESK0 = -LOG(0.5D0*X)*DBESI0(X) - 0.25D0 + DCSEVL (.5D0*Y-1.D0, BK0CS, NTK0)
      RETURN
!
 20   DBESK0 = 0.D0
      IF (X .GT. XMAX) CALL XERMSG ('SLATEC', 'DBESK0', 'X SO BIG K0 UNDERFLOWS', 1, 1)
      IF (X.GT.XMAX) RETURN
!
      DBESK0 = EXP(-X) * DBSK0E(X)
!
      RETURN
END FUNCTION DBESK0


!---DECK DBESK1
!=============================================================================!
!
FUNCTION DBESK1 (X)
!
!=============================================================================!
!
!***BEGIN PROLOGUE  DBESK1
!***PURPOSE  Compute the modified (hyperbolic) Bessel function of the
!            third kind of order one.
!***LIBRARY   SLATEC (FNLIB)
!***CATEGORY  C10B1
!***TYPE      DOUBLE PRECISION (BESK1-S, DBESK1-D)
!***KEYWORDS  FNLIB, HYPERBOLIC BESSEL FUNCTION,
!             MODIFIED BESSEL FUNCTION, ORDER ONE, SPECIAL FUNCTIONS,
!             THIRD KIND
!***AUTHOR  Fullerton, W., (LANL)
!***DESCRIPTION
!
! DBESK1(X) calculates the double precision modified (hyperbolic)
! Bessel function of the third kind of order one for double precision
! argument X.  The argument must be large enough that the result does
! not overflow and small enough that the result does not underflow.
!
! Series for BK1        on the interval  0.          to  4.00000E+00
!                                        with weighted error   9.16E-32
!                                         log weighted error  31.04
!                               significant figures required  30.61
!                                    decimal places required  31.64
!
!***REFERENCES  (NONE)
!***ROUTINES CALLED  D1MACH, DBESI1, DBSK1E, DCSEVL, INITDS, XERMSG
!***REVISION HISTORY  (YYMMDD)
!   770701  DATE WRITTEN
!   890531  Changed all specific intrinsics to generic.  (WRB)
!   890531  REVISION DATE from Version 3.2
!   891214  Prologue converted to Version 4.0 format.  (BAB)
!   900315  CALLs to XERROR changed to CALLs to XERMSG.  (THJ)
!***END PROLOGUE  DBESK1
      DOUBLE PRECISION X, BK1CS(16), XMAX, XMAXT, XMIN, XSML, Y, DBESK1
      LOGICAL FIRST
      INTEGER NTK1
      SAVE BK1CS, NTK1, XMIN, XSML, XMAX, FIRST
      DATA BK1CS(  1) / +.25300227338947770532531120868533D-1     /
      DATA BK1CS(  2) / -.35315596077654487566723831691801D+0     /
      DATA BK1CS(  3) / -.12261118082265714823479067930042D+0     /
      DATA BK1CS(  4) / -.69757238596398643501812920296083D-2     /
      DATA BK1CS(  5) / -.17302889575130520630176507368979D-3     /
      DATA BK1CS(  6) / -.24334061415659682349600735030164D-5     /
      DATA BK1CS(  7) / -.22133876307347258558315252545126D-7     /
      DATA BK1CS(  8) / -.14114883926335277610958330212608D-9     /
      DATA BK1CS(  9) / -.66669016941993290060853751264373D-12    /
      DATA BK1CS( 10) / -.24274498505193659339263196864853D-14    /
      DATA BK1CS( 11) / -.70238634793862875971783797120000D-17    /
      DATA BK1CS( 12) / -.16543275155100994675491029333333D-19    /
      DATA BK1CS( 13) / -.32338347459944491991893333333333D-22    /
      DATA BK1CS( 14) / -.53312750529265274999466666666666D-25    /
      DATA BK1CS( 15) / -.75130407162157226666666666666666D-28    /
      DATA BK1CS( 16) / -.91550857176541866666666666666666D-31    /
      DATA FIRST /.TRUE./
!***FIRST EXECUTABLE STATEMENT  DBESK1
      IF (FIRST) THEN
         NTK1 = INITDS (BK1CS, 16, 0.1*REAL(D1MACH(3)))
         XMIN = EXP(MAX(LOG(D1MACH(1)), -LOG(D1MACH(2))) + 0.01D0)
         XSML = SQRT(4.0D0*D1MACH(3))
         XMAXT = -LOG(D1MACH(1))
         XMAX = XMAXT - 0.5D0*XMAXT*LOG(XMAXT)/(XMAXT+0.5D0)
      ENDIF
      FIRST = .FALSE.
!
      IF (X .LE. 0.D0) CALL XERMSG ('SLATEC', 'DBESK1', 'X IS ZERO OR NEGATIVE', 2, 2)
      IF (X.GT.2.0D0) GO TO 20
!
      IF (X .LT. XMIN) CALL XERMSG ('SLATEC', 'DBESK1', 'X SO SMALL K1 OVERFLOWS', 3, 2)
      Y = 0.D0
      IF (X.GT.XSML) Y = X*X
      DBESK1 = LOG(0.5D0*X)*DBESI1(X) + (0.75D0 + DCSEVL (.5D0*Y-1.D0, BK1CS, NTK1))/X
      RETURN
!
 20   DBESK1 = 0.D0
      IF (X .GT. XMAX) CALL XERMSG ('SLATEC', 'DBESK1',  'X SO BIG K1 UNDERFLOWS', 1, 1)
      IF (X.GT.XMAX) RETURN
!
      DBESK1 = EXP(-X) * DBSK1E(X)
!
      RETURN
END FUNCTION DBESK1


END MODULE DBSK01